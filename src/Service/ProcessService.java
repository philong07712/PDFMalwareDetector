package Service;

public class ProcessService {

    public static void main(String[] args) {
        String sha256 = getSHA256Code("D:\\SafeDocs\\Download\\d421776482bbb7e372f6e280fd07a92ae39ae8bb753d4c1c0437a95e50d9e");
        VirusTotalService.searchFile(sha256);
    }

    public static String sha256Code = "";
    public static String getSHA256Code(String path) {
        try {
            Process p = Runtime.getRuntime().exec("CertUtil -hashfile " + path + " SHA256");
            CommandService.getInstance().parseSHA(p.getInputStream());
            CommandService.getInstance().parseSHA(p.getErrorStream());
            p.waitFor();
            System.out.println(sha256Code);
            if (Utility.canBeSHA256(sha256Code)) {
                // it is sha 256
                Main.gui.addLog("It is SHA 256: " + sha256Code);
                return sha256Code;
            } else {
                // it is not
                Main.gui.addLog("It is not SHA 256 ");
                return "";
            }
        } catch (Exception e) {
            e.printStackTrace();
            return "";
        }
    }
}
